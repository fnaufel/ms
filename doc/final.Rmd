---
title: 'Estrat√©gias para a Mega-sena'
author: 'fnaufel'
email: 'https://fnaufel.github.io/'
date: 'Vers√£o de `r format(Sys.Date(), "%d/%m/%Y")`'
lang: 'pt'
# TODO: include LaTeX fields
output: 
  html_document:
    theme: readable
           # https://bootswatch.com/3/readable/
    highlight: tango
    css: styles.css
    toc: true
    toc_depth: 2
    number_sections: true
    fig_caption: true
    df_print: paged
    self_contained: true
    # code_folding: show
    # keep_md: true
    # includes:
    #   in_header: header.html
    #   before_body: doc_prefix.html
    #   after_body: doc_suffix.html
---

```{r setup, include=FALSE}
library(knitr)

opts_chunk$set(
  echo = FALSE, 
  # collapse = TRUE,
  # cache = TRUE,
  out.width = "75%",
  fig.align = 'center',
  fig.width = 6,
  fig.show = "hold"
)

options(dplyr.print_min = 6, dplyr.print_max = 6)

# Supress crayon output
options(crayon.enabled = FALSE)

#library()

# For nice tables
library(gt)

# For nice dataframe summaries
library(summarytools)
st_options(
  plain.ascii = FALSE,
  dfSummary.varnumbers = FALSE,
  dfSummary.style = 'grid',
  dfSummary.graph.magnif = .75
)

# Tidy!
library(tidyverse)

# Sober theme for ggplot
theme_set(
  theme_linedraw() +                         # Set simple theme for ggplot
    theme(                                   # with some tweaks
      axis.title.y.left = element_text(
         angle = 0,                          # Never rotate y axis title
         margin = margin(r = 20),            # Separate y axis title a little 
         vjust = .5                          # Leave y axis title in the middle
      ),
      axis.title.x.bottom = element_text(
         margin = margin(t = 20)             # Separate x axis title a little 
      ),
      axis.line = element_blank(),           # No axis lines
      panel.border = element_blank(),        # No frame
      panel.grid.minor = element_blank()     # No grid minor lines
    )
)

# Avoid scientific notation and use a comma as decimal separator
options(
  scipen = 15,
  OutDec = ','
)

# Format a number with thousand separators (default point)
# and decimal comma enclosed in curly braces for LaTeX printing.
# CAREFUL: if called outside math mode, will print the braces!
fm <- function(x, big = '.', decimal = '{,}') {
  if (!is.numeric(x)) {
    x
  } else {
    prettyNum(x, big.mark = big, decimal.mark = decimal)
  }

}

# To center the results of a chunk (image, video etc.)
# Usage: 
#         out.extra=center()
#         
center <- function(){
  
  if (is_html_output()) {
    'class="center"'
  }
  
}


# To embed YT videos in HTML and the link (centered) in LaTeX
embed_yt <- function(code) {

  if (is_html_output()) {
    include_url(
      paste0(
        'https://www.youtube.com/embed/',
        code
      )
    )
  } else {
    cat(
      paste0(
        '```{=latex}\n',
        '\\begin{center} \\url{https://youtu.be/',
        code,
        '} \\end{center}\n',
        '```'
      )
    )
  }
  
}

source('../packages.R')

loadd(
  df,
  df_sucessos_raras, 
  n_raras,
  df_sucessos_freqs,
  df_vetor,
  df_summary,
  df_regress,
  arrec_resultados, 
  n_recentes, 
  rsq_CEF,
  quadra_resultados,
  quina_resultados,
  sena_resultados,
  premios
)

```

```{js javascript-init, echo=FALSE}

// Make off-site links open in a new window/tab
function changeTargets() {
  $("a").attr(
    "target", function() {
      // Load local links locally
      if (this.host == location.host) return "_self"
      // Load off-site links in a new window
      else return "_blank";
    }
  );
}

// Execute when document is ready
$(
  changeTargets
)
```

# Introdu√ß√£o

???

http://loterias.caixa.gov.br/wps/portal/loterias/landing/megasena

Dados de http://www1.caixa.gov.br/loterias/_arquivos/loterias/D_mgsasc.zip

???

# Dicion√°rio de dados 

`num`

  : n√∫mero do concurso

`data`

  : data do concurso

`d1 ... d5`

  : dezenas sorteadas
  
`arrec`

  : arrecada√ß√£o total
  
`g_sena, g_quina, g_quadra`

  : quantidades de ganhadores
  
`r_sena, r_quina, r_quadra`

  : rateios para cada faixa, i.e., valor de cada pr√™mio *individual* na faixa
  
`acumulou`

  : `true` se o pr√™mio da sena acumulou
  
`valor_ac`

  : valor acumulado
  
`est_prox`

  : estimativa do pr√™mio *total* da sena no pr√≥ximo concurso
  
`ac_virada`

  : valor acumulado at√© agora para a mega-sena da virada
  

# Estat√≠sticas

```{r}
df_summary %>% print(method = 'render')
```


# Estrat√©gias que n√£o funcionam

## Frequ√™ncias

::: {.rmdwarning}

Cada sorteio √© independente, e a [Lei dos Grandes N√∫meros](https://pt.wikipedia.org/wiki/Lei_dos_grandes_n%C3%BAmeros) s√≥ fala sobre o comportamento dos resultados *quando o n√∫mero de sorteios tende ao infinito*. At√© agora, houve $`r df %>% nrow() %>% fm()`$ sorteios, uma quantidade infinitamente menor do que infinitos sorteios. üòú

:::

```{r}
dezenas <- tibble(
  dezena = c(
    df %>% pull(d1),
    df %>% pull(d2),
    df %>% pull(d3),
    df %>% pull(d4),
    df %>% pull(d5),
    df %>% pull(d6)
  )
)
```


```{r}
nsorteios <- nrow(df)
media <- nsorteios / 10

dezenas %>% 
  ggplot(aes(dezena)) + 
    geom_histogram(binwidth = 1, fill = 'light gray', color = 'black') +
    geom_hline(aes(yintercept = media), color = 'red') +
    labs(
      y = NULL,
      title = paste0(
        'Frequ√™ncia de cada dezena ap√≥s ',
        nsorteios,
        ' sorteios'
      ),
      subtitle = 'frequ√™ncia te√≥rica (uniforme) em vermelho'
    ) +
    scale_x_continuous(breaks = c(1, c(seq(0, 60, 5))[-1]))
```

Um erro comum √© achar que as dezenas que foram menos sorteadas em concursos anteriores t√™m probabilidade maior de sair no pr√≥ximo concurso.

```{r}
n_concursos <- nrow(df_sucessos_raras)
```

Em uma simula√ß√£o, jogamos, em cada concurso, as $`r n_raras`$ dezenas que tinham a menor frequ√™ncia acumulada em todos os concursos anteriores. As quantidades de acertos em $`r n_concursos %>% fm()`$ concursos foram:

```{r echo=FALSE}
df_sucessos_raras %>% 
  count(n_acertos) %>% 
  mutate(
    n = n %>% fm()
  ) %>% 
  rename(
    Acertos = n_acertos,
    Concursos = n
  ) %>% 
  gt() %>% 
    cols_align('right')
```

Outras pessoas dizem que as dezenas mais frequentes s√£o as mais "quentes", e t√™m maior probabilidade de sair. Em outra simula√ß√£o, jogamos, em cada concurso, as $`r n_raras`$ dezenas que tinham a *maior* frequ√™ncia acumulada em todos os concursos anteriores. As quantidades de acertos em $`r n_concursos %>% fm()`$ concursos foram:

```{r echo=FALSE}
df_sucessos_freqs %>% 
  count(n_acertos) %>% 
  mutate(
    n = n %>% fm()
  ) %>% 
  rename(
    Acertos = n_acertos,
    Concursos = n
  ) %>% 
  gt() %>% 
    cols_align('right')
```


```{r echo=FALSE}
source('../R/computar_acertos.R')

# Jogar as mesmas 6 dezenas (escolhidas ao acaso) em todos os jogos
mesmas_dezenas <- tibble(
  num = 1:nrow(df_vetor),
  dezenas = list(sample(1:60, n_raras))
)
```

Para comparar, eis os n√∫meros de acertos se jogarmos as mesmas $`r n_raras`$ dezenas ($`r sort(mesmas_dezenas$dezenas[[1]])`$) em todos os concursos:

```{r echo=FALSE}
# Quantidade de acertos em cada concurso, jogando as dezenas escolhidas acima
df_sucessos_mesmas <- computar_acertos(df_vetor, mesmas_dezenas)

df_sucessos_mesmas %>% 
  count(n_acertos) %>% 
  mutate(
    n = n %>% fm()
  ) %>% 
  rename(
    Acertos = n_acertos,
    Concursos = n
  ) %>% 
  gt() %>% 
    cols_align('right')
```

Quaisquer diferen√ßas entre as $3$ situa√ß√µes s√£o pequenas, devidas somente ao acaso.

## Dezenas pares, √≠mpares, em quadrantes, etc.

???

# Probabilidades

A f√≥rmula geral para 

* $a$ acertos
* $j$ n√∫meros jogados
* $s$ n√∫meros sorteados dentre
* $t$ n√∫meros no total

√©

$$
\Pr(a \mid j, s, t) = \frac{{j \choose a}{t - j \choose s - a}}{t \choose s}
$$

O total de resultados poss√≠veis √© $t \choose s$.

A id√©ia √© que, fixados os $j$ n√∫meros jogados, para determinar a quantidade de resultados que t√™m exatamente $a$ acertos, √© preciso

* determinar os acertos dentre os jogados: $j \choose a$

* determinar os n√∫meros sorteados restantes (que n√£o podem ter sido jogados): $t - j \choose s - a$

Na verdade, o n√∫mero de acertos segue a [distribui√ß√£o hipergeom√©trica](https://pt.wikipedia.org/wiki/Distribui%C3%A7%C3%A3o_hipergeom%C3%A9trica).

```{r}
jogados <- 6:15
valor = c(
  4.50, 
  31.50, 
  126.00, 
  378.00, 
  945.00, 
  2079.00, 
  4158.00, 
  7722.00, 
  13513.5, 
  22522.5
)

sena <- dhyper(x = 6, m = jogados, n = 60 - jogados, k = 6) %>% round(10)
quina <- dhyper(x = 5, m = jogados, n = 60 - jogados, k = 6) %>% round(10)
quadra <- dhyper(x = 4, m = jogados, n = 60 - jogados, k = 6) %>% round(10)

probs <- tibble(jogados, valor, sena, quina, quadra)

sena <- (1/dhyper(x = 6, m = jogados, n = 60 - jogados, k = 6)) %>% round(0)
quina <- (1/dhyper(x = 5, m = jogados, n = 60 - jogados, k = 6)) %>% round(0)
quadra <- (1/dhyper(x = 4, m = jogados, n = 60 - jogados, k = 6)) %>% round(0)

chances <- tibble(jogados, valor, sena, quina, quadra)
```

As chances de acertar s√£o de $1$ em...

```{r}
chances %>% 
  gt() %>% 
    cols_align('right') %>% 
    fmt_number(
      c(1, 3, 4, 5), 
      dec_mark = ',',
      sep_mark = '.',
      decimals = 0
    ) %>% 
    fmt_number(
      2, 
      dec_mark = ',',
      sep_mark = '.'
    ) 
```

Dito de outro modo, as probabilidades de acertar s√£o

```{r}
probs %>% 
  gt() %>% 
    cols_align('right') %>% 
    fmt_number(
      c(3, 4, 5), 
      dec_mark = ',',
      sep_mark = '.',
      decimals = 10
    ) %>% 
    fmt_number(
      2, 
      dec_mark = ',',
      sep_mark = '.'
    ) 
```

Para fins de compara√ß√£o, as probabilidades de voc√™ lan√ßar uma moeda n√£o-viciada $n$ vezes e obter cara em *todos* os lan√ßamentos s√£o de

```{r}
n <- 1:25
probabilidade <- 1/2^n
tibble(n, probabilidade) %>% 
  gt() %>% 
    cols_align('right')
```


# Estimativas

## Corrigindo a estimativa de arrecada√ß√£o da CEF

```{r}
previsoes <- arrec_resultados$validacao
modelo <- arrec_resultados$modelo %>% pull_workflow_fit()

b0 <- modelo$fit$coefficients[1] %>% round(2) %>% fm()
b1 <- modelo$fit$coefficients[2] %>% round(2) %>% fm()

n_previsoes <- nrow(previsoes)
rsq <- previsoes %>% 
  metrics(truth = arrec, estimate = .pred) %>% 
  filter(.metric == 'rsq') %>% 
  pull(.estimate)
```

Ap√≥s cada concurso, a CEF faz uma estimativa da arrecada√ß√£o do concurso seguinte. Examinando os dados, vemos que essas estimativas costumam ficar abaixo dos valores reais.

Usamos regress√£o linear para construir um modelo da arrecada√ß√£o real em fun√ß√£o da estimativa da CEF, com base nas informa√ß√µes dos $`r n_recentes`$ √∫ltimos concursos (excluindo os concursos da virada, que t√™m arrecada√ß√µes at√≠picas).

Este gr√°fico mostra as dist√¢ncias entre as arrecada√ß√µes reais (os pontos) e as estimativas do nosso modelo (representadas pela reta azul). A √°rea sombreada mostra um intervalo de confian√ßa de $95\%$:

```{r}
previsoes %>% 
  ggplot(aes(x = est_arrec)) +
    geom_ribbon(
      aes(ymin = .pred_lower, ymax = .pred_upper), 
      fill = 'light blue',
      alpha = .3
    ) +
    geom_line(aes(y = .pred), color = 'blue', size = 1) +
    geom_line(aes(y = est_arrec), color = 'gray', size = 1) +
    geom_point(aes(y = arrec)) +
    labs(
      title = glue(
        'Nosso modelo para a arrecada√ß√£o (azul)',
        '\nnos √∫ltimos {n_recentes} concursos'
      ),
      subtitle = 'com base nas estimativas da CEF (cinza)', 
      x = 'Estimativa da CEF',
      y = 'Arrecada√ß√£o'
    ) +
    scale_x_continuous(
      labels = scales::label_dollar(suffix = 'M', big.mark = ' ')
    ) +
    scale_y_continuous(
      labels = scales::label_dollar(suffix = 'M', big.mark = ' ')
    )
```

O gr√°fico mostra que as estimativas da CEF (a linha cinza) costumam ser mais baixas do que as arrecada√ß√µes reais. Nosso modelo corrige esta tend√™ncia. 

::: {.rmdimportant}

### Conclus√£o {-}

A arrecada√ß√£o real e a estimativa da CEF est√£o relacionadas, *em m√©dia*, pela equa√ß√£o
$$
\text{arrecada√ß√£o} = `r b0` + `r b1` \times \text{estimativa}
$$
com arrecada√ß√£o e estimativa em milh√µes de reais.

:::

Nosso modelo (como qualquer outro) n√£o √© perfeito --- a reta n√£o passa por todos os pontos --- mas ele d√° conta de $`r (rsq %>% round(3) * 100) %>% fm()`\%$ da varia√ß√£o das arrecada√ß√µes; i.e., $R^2 = `r rsq %>% round(3) %>% fm()`$. Em compara√ß√£o, as estimativas da CEF tinham $R^2 = `r rsq_CEF %>% round(3) %>% fm()`$.

Eis um gr√°fico comparando as estimativas mais recentes do nosso modelo com a arrecada√ß√£o real e as estimativas da CEF:

```{r}
previsoes %>% 
  ggplot(aes(x = data)) +
    geom_line(aes(y = arrec, color = 'Arrecada√ß√£o real'), size = 1) +
    geom_line(aes(y = .pred, color = 'Nossa estimativa'), size = 1) +
    geom_line(aes(y = est_arrec, color = 'Estimativa da CEF'), size = 1) +
    scale_color_hue() +
    scale_y_continuous(
      labels = scales::label_dollar(suffix = 'M', big.mark = ' '),
      limits = c(0, NA)
    ) +
    labs(
      title = glue(
        'Nossa estimativa para a arrecada√ß√£o nos √∫ltimos {n_previsoes} concursos',
      ),
      subtitle = 'em compara√ß√£o com a arrecada√ß√£o real e a estimativa da CEF',
      x = NULL,
      y = NULL,
      color = NULL
    ) +
    theme(legend.position = 'bottom')
```

## Estimando ganhadores da quadra

```{r}
previsoes <- quadra_resultados$validacao
modelo <- quadra_resultados$modelo %>% pull_workflow_fit()

b0 <- modelo$fit$coefficients[1] %>% round(2) %>% fm()
b1 <- modelo$fit$coefficients[2] %>% round(2) %>% fm()

n_previsoes <- nrow(previsoes)
rsq <- previsoes %>% 
  metrics(truth = g_quadra, estimate = .pred) %>% 
  filter(.metric == 'rsq') %>% 
  pull(.estimate)
```

√â razo√°vel que, quanto maior a arrecada√ß√£o, maior a quantidade de jogadores e maior a quantidade de ganhadores da quadra.

O gr√°fico abaixo mostra um modelo linear para o n√∫mero de ganhadores da quadra com base na estimativa de arrecada√ß√£o da CEF. O modelo d√° conta de $`r (rsq %>% round(3) * 100) %>% fm()`\%$ da varia√ß√£o no n√∫mero de ganhadores.

```{r}
previsoes %>% 
  ggplot(aes(x = est_arrec)) +
    geom_ribbon(
      aes(ymin = .pred_lower, ymax = .pred_upper), 
      fill = 'light blue',
      alpha = .3
    ) +
    geom_line(aes(y = .pred), color = 'blue', size = 1) +
    geom_point(aes(y = g_quadra)) +
    labs(
      title = glue(
        'Nosso modelo para ganhadores da quadra',
        '\nnos √∫ltimos {n_previsoes} concursos'
      ),
      subtitle = 'com base nas estimativas da CEF',
      x = 'Estimativa da CEF',
      y = 'Ganhadores'
    ) +
    scale_x_continuous(
      labels = scales::label_dollar(suffix = 'M', big.mark = ' ')
    )
```

::: {.rmdimportant}

### Conclus√£o {-}

O n√∫mero de ganhadores da quadra e a estimativa da CEF est√£o relacionadas, *em m√©dia*, pela equa√ß√£o
$$
\text{ganhadores da quadra} = `r b0` + `r b1` \times \text{estimativa}
$$
com estimativa em milh√µes de reais.

:::


## Estimando ganhadores da quina

```{r}
previsoes <- quina_resultados$validacao
modelo <- quina_resultados$modelo %>% pull_workflow_fit()

b0 <- modelo$fit$coefficients[1] %>% round(2) %>% fm()
b1 <- modelo$fit$coefficients[2] %>% round(2) %>% fm()

n_previsoes <- nrow(previsoes)
rsq <- previsoes %>% 
  metrics(truth = g_quina, estimate = .pred) %>% 
  filter(.metric == 'rsq') %>% 
  pull(.estimate)
```

O mesmo racioc√≠nio se aplica ao n√∫mero de ganhadores da quina.

O gr√°fico abaixo mostra um modelo linear para o n√∫mero de ganhadores da quina com base na estimativa de arrecada√ß√£o da CEF. O modelo d√° conta de $`r (rsq %>% round(3) * 100) %>% fm()`\%$ da varia√ß√£o no n√∫mero de ganhadores.

```{r}
previsoes %>% 
  ggplot(aes(x = est_arrec)) +
    geom_ribbon(
      aes(ymin = .pred_lower, ymax = .pred_upper), 
      fill = 'light blue',
      alpha = .3
    ) +
    geom_line(aes(y = .pred), color = 'blue', size = 1) +
    geom_point(aes(y = g_quina)) +
    labs(
      title = glue(
        'Nosso modelo para ganhadores da quina',
        '\nnos √∫ltimos {n_previsoes} concursos'
      ),
      subtitle = 'com base nas estimativas da CEF',
      x = 'Estimativa da CEF',
      y = 'Ganhadores'
    ) +
    scale_x_continuous(
      labels = scales::label_dollar(suffix = 'M', big.mark = ' ')
    )
```

::: {.rmdimportant}

### Conclus√£o {-}

O n√∫mero de ganhadores da quina e a estimativa da CEF est√£o relacionadas, *em m√©dia*, pela equa√ß√£o
$$
\text{ganhadores da quina} = `r b0` + `r b1` \times \text{estimativa}
$$
com estimativa em milh√µes de reais.

:::


## Estimando ganhadores da sena

```{r}
n_concursos <- nrow(df_vetor)
sem_sena <- df_vetor %>% filter(g_sena == 0) %>% nrow()
com_sena <- n_concursos - sem_sena
perc_sena <- (100 * (com_sena / n_concursos)) %>% round(0) 
```

Os ganhadores da sena s√£o poucos: dos $`r n_concursos %>% fm()`$ concursos realizados at√© agora, apenas $`r com_sena %>% fm()`$ ($`r perc_sena %>% fm()`\%$) tiveram ganhadores da sena.

```{r}
previsoes <- sena_resultados$validacao
modelo <- sena_resultados$modelo %>% pull_workflow_fit()

n_previsoes <- nrow(previsoes)
rsq <- previsoes %>% 
  metrics(truth = g_sena, estimate = .pred) %>% 
  filter(.metric == 'rsq') %>% 
  pull(.estimate)
```

Ganhadores da sena s√£o t√£o raros que um modelo linear para estimar sua quantidade com base na arrecada√ß√£o prev√™, em m√©dia, *menos que $1$ ganhador em todos os casos*:

```{r}
previsoes %>% 
  ggplot(aes(x = est_arrec)) +
    geom_ribbon(
      aes(ymin = max(.pred_lower, 0), ymax = .pred_upper),
      fill = 'light blue',
      alpha = .3
    ) +
    geom_line(aes(y = .pred), color = 'blue', size = 1) +
    geom_point(aes(y = g_sena)) +
    labs(
      title = glue(
        'Nosso modelo para ganhadores da sena',
        '\nnos √∫ltimos {n_previsoes} concursos'
      ),
      subtitle = 'com base nas estimativas da CEF',
      x = 'Estimativa da CEF',
      y = 'Ganhadores'
    ) +
    scale_x_continuous(
      labels = scales::label_dollar(suffix = 'M', big.mark = ' ')
    ) +
    scale_y_continuous(breaks = 0:max(previsoes$g_sena))
```

Por isso, n√£o vamos trabalhar com estimativas sobre a sena.

Mas isto n√£o nos impede de observar alguns fatos interessantes:

```{r}
n_ganhadores <- df_vetor %>% 
  count(g_sena) %>% 
  rename(
    Ganhadores = g_sena,
    Concursos = n
  ) %>% 
  gt() %>% 
    cols_align('right')

muitos_ganhadores <- df_vetor %>% 
  filter(g_sena > 7) %>% 
  select(data, g_sena, r_sena) %>% 
  mutate(
    data = format(data, "%d/%m/%Y"),
    r_sena = r_sena %>% round(0) %>% fm()
  ) %>% 
  rename(
    Data = data,
    Ganhadores = g_sena,
    'Pr√™mio (R$)' = r_sena
  ) %>% 
  gt() %>% 
    cols_align('right')
  
virada <- df_vetor %>% 
  filter(month(data) == 12 & day(data) == 31) %>% 
  select(data, g_sena, r_sena) %>% 
  mutate(
    data = format(data, "%d/%m/%Y"),
    r_sena = r_sena %>% round(0) %>% fm()
  ) %>% 
  rename(
    Data = data,
    Ganhadores = g_sena,
    'Pr√™mio (R$)' = r_sena
  ) %>% 
  gt() %>% 
    cols_align('right')
  

```


* Quantidades de ganhadores:

    ```{r}
    n_ganhadores
    ```
    
* Eis os concursos com mais ganhadores, com os valores dos pr√™mios individuais:

    ```{r}
    muitos_ganhadores
    ```

* As mega-senas da virada costumam ter n√∫mero alto de ganhadores da sena, pelo menos de $2010$ para c√°. Ali√°s, para f√£s de teorias da conspira√ß√£o: o que houve depois de $2018$?

    ```{r}
    virada
    ```




## Estimando rateios 

Para prever os valores dos pr√™mios individuais da quadra e da quina, o ideal seria achar um modelo dos rateios em fun√ß√£o da arrecada√ß√£o estimada.

Uma id√©ia razo√°vel √© que, quanto maior a arrecada√ß√£o total, maior o n√∫mero de ganhadores e, da√≠, menor o valor do rateio.

Mas, quando vemos os gr√°ficos, percebemos que isto n√£o √© verdade.

Para a quina:

```{r}
n_previsoes <- nrow(df_regress)

df_regress %>% 
  ggplot(aes(x = est_arrec, y = r_quina)) +
    geom_point(alpha = .5) +
    scale_x_continuous(labels = scales::dollar_format(suffix = 'M')) +
    scale_y_continuous(
      labels = scales::dollar_format(big.mark = '.', decimal.mark = ',')
    ) +
    geom_smooth(method = 'lm', se = FALSE, formula = y ~ x) +
    labs(
      title = glue(
        'Valor do pr√™mio individual da quina',
        '\nnos √∫ltimos {n_previsoes} concursos'
      ),
      subtitle = 'em fun√ß√£o da arrecada√ß√£o estimada',
      y = 'pr√™mio\nindividual',
      x = 'arrecada√ß√£o estimada'
    )
```

A reta mostra que, em m√©dia, o valor do rateio da quina praticamente *n√£o muda* em fun√ß√£o da arrecada√ß√£o estimada.

Algo parecido acontece com o valor do pr√™mio individual da quadra:

```{r}
df_regress %>% 
  ggplot(aes(x = est_arrec, y = r_quadra)) +
    geom_point(alpha = .5) +
    scale_x_continuous(labels = scales::dollar_format(suffix = 'M')) +
    scale_y_continuous(
      labels = scales::dollar_format(big.mark = '.', decimal.mark = ',')
    ) +
    geom_smooth(method = 'lm', se = FALSE, formula = y ~ x) +
    labs(
      title = glue(
        'Valor do pr√™mio individual da quadra',
        '\nnos √∫ltimos {n_previsoes} concursos'
      ),
      subtitle = 'em fun√ß√£o da arrecada√ß√£o estimada',
      y = 'pr√™mio\nindividual',
      x = 'arrecada√ß√£o estimada'
    )
```

# Valores esperados

## Pr√™mios

```{r}
premios %>% 
  mutate(jogados = paste(jogados, 'jogados:')) %>% 
  gt(groupname_col = 'jogados') %>% 
    tab_stubhead(label = 'jogados') %>% 
    opt_row_striping()
```

```{r}
premios %>% kable()
```


???

